
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Using the occ Command &mdash; ownCloud Server Administration Manual 8.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '8.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/bootstrap.js"></script>
    <link rel="top" title="ownCloud Server Administration Manual 8.1 documentation" href="../index.html" />
    <link rel="up" title="ownCloud Server Configuration" href="index.html" />
    <link rel="next" title="Configuring the Activity App" href="activity_configuration.html" />
    <link rel="prev" title="ownCloud Server Configuration" href="index.html" />
<script type="text/javascript">
(function () {
  /**
   * Patch TOC list.
   *
   * Will mutate the underlying span to have a correct ul for nav.
   *
   * @param $span: Span containing nested UL's to mutate.
   * @param minLevel: Starting level for nested lists. (1: global, 2: local).
   */
  var patchToc = function ($ul, minLevel) {
    var findA;

    // Find all a "internal" tags, traversing recursively.
    findA = function ($elem, level) {
      var level = level || 0,
        $items = $elem.find("> li > a.internal, > ul, > li > ul");

      // Iterate everything in order.
      $items.each(function (index, item) {
        var $item = $(item),
          tag = item.tagName.toLowerCase(),
          pad = 15 + ((level - minLevel) * 10);

        if (tag === 'a' && level >= minLevel) {
          // Add to existing padding.
          $item.css('padding-left', pad + "px");
          console.log(level, $item, 'padding-left', pad + "px");
        } else if (tag === 'ul') {
          // Recurse.
          findA($item, level + 1);
        }
      });
    };

    console.log("HERE");
    findA($ul);
  };

  $(document).ready(function () {
    // Add styling, structure to TOC's.
    $(".dropdown-menu").each(function () {
      $(this).find("ul").each(function (index, item){
        var $item = $(item);
        $item.addClass('unstyled');
      });
      $(this).find("li").each(function () {
        $(this).parent().append(this);
      });
    });

    // Patch in level.
    patchToc($("ul.globaltoc"), 2);
    patchToc($("ul.localtoc"), 2);

    // Enable dropdown.
    $('.dropdown-toggle').dropdown();
  });
}());
</script>

  </head>
  <body>
  

<div class="container">
  <div class="content">
    <div class="page-header">
      <h1><a href="../contents.html">ownCloud Server Administration Manual</a></h1>

    </div>
    
			<div class="row">
				<div class="span3">
					<div class="sidebar">
						<div class="well">
							<div class="menu-support-container">
								<ul id="menu-support" class="menu">
									<ul>
										
<li><a href="../contents.html">Table of Contents</a></li>
									</ul>
                  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">ownCloud 8.1 Server Administration Manual Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">ownCloud 8.1 Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../whats_new_admin.html">What&#8217;s New for Admins in ownCloud 8</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration_user/index.html">User Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration_files/index.html">File Sharing and Management</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">ownCloud Server Configuration</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="">Using the occ Command</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#maintenance-commands">Maintenance Commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="#user-commands">User Commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="#apps-commands">Apps Commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="#upgrade-command">Upgrade Command</a></li>
<li class="toctree-l3"><a class="reference internal" href="#database-conversion">Database Conversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ldap-commands">LDAP Commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="#file-scanning">File Scanning</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="activity_configuration.html">Configuring the Activity App</a></li>
<li class="toctree-l2"><a class="reference internal" href="antivirus_configuration.html">Configuring the ClamAV Antivirus Scanner</a></li>
<li class="toctree-l2"><a class="reference internal" href="automatic_configuration.html">Automatic Configuration Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="background_jobs_configuration.html">Defining Background Jobs</a></li>
<li class="toctree-l2"><a class="reference internal" href="config_sample_php_parameters.html">Config.php Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="email_configuration.html">Email Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="js_css_asset_management_configuration.html">JavaScript and CSS Asset Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="knowledgebase_configuration.html">Knowledge Base Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="language_configuration.html">Language Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="logging_configuration.html">Logging Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="harden_server.html">Hardening and Security Guidance</a></li>
<li class="toctree-l2"><a class="reference internal" href="performance_tuning.html">Server Tuning &amp; Performance Tips</a></li>
<li class="toctree-l2"><a class="reference internal" href="reverse_proxy_configuration.html">Reverse Proxy Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="search_configuration.html">Enabling Full-Text Search</a></li>
<li class="toctree-l2"><a class="reference internal" href="thirdparty_php_configuration.html">Using Third Party PHP Components</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../configuration_database/index.html">Database Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../maintenance/index.html">Maintenance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operations/index.html">Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../issues/index.html">Issues and Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../videos/index.html">ownCloud Videos</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../enterprise_installation/index.html">Enterprise Subscription Installation (ES Only)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../enterprise_clients/index.html">Creating Custom and Branded ownCloud Clients (ES only)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../enterprise_external_storage/index.html">External Storage (ES only)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../enterprise_user_management/index.html">User Management (ES only)</a></li>
</ul>

								</ul>
							</div>
						</div>
					</div>
				</div>
        

				<div class="span9">
					<div class="page-content">
						
  <div class="section" id="using-the-occ-command">
<h1>Using the occ Command<a class="headerlink" href="#using-the-occ-command" title="Permalink to this headline">Â¶</a></h1>
<p>ownCloud&#8217;s <tt class="docutils literal"><span class="pre">occ</span></tt> command (ownCloud console) is ownCloud&#8217;s command-line
interface. You can perform many common server operations with <tt class="docutils literal"><span class="pre">occ</span></tt>:</p>
<div class="highlight-python"><pre>* Manage apps
* Upgrade the ownCloud database
* Reset passwords, including administrator passwords
* Convert the ownCloud database from SQLite to a more performant DB
* Query and change LDAP settings</pre>
</div>
<p><tt class="docutils literal"><span class="pre">occ</span></tt> is in the <tt class="file docutils literal"><span class="pre">owncloud/</span></tt> directory; for example
<tt class="file docutils literal"><span class="pre">/var/www/owncloud</span></tt> on Ubuntu Linux. <tt class="docutils literal"><span class="pre">occ</span></tt> is a PHP script. You must run
it as your HTTP user to ensure that the correct permissions are maintained on
your ownCloud files and directories.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The HTTP user is different on the various Linux distributions. See
the <strong>Setting Strong Directory Permissions</strong> section of
<a class="reference internal" href="../installation/installation_wizard.html"><em>Installation Wizard</em></a> to learn how to find your HTTP
user</p>
</div>
<p>Running it with no options lists all commands and options, like this example on
Ubuntu:</p>
<div class="highlight-python"><pre>$ sudo -u www-data php occ</pre>
</div>
<p>This is the same as <tt class="docutils literal"><span class="pre">sudo</span> <span class="pre">-u</span> <span class="pre">www-data</span> <span class="pre">php</span> <span class="pre">occ</span> <span class="pre">list</span></tt>.</p>
<p>Run it with the <tt class="docutils literal"><span class="pre">-h</span></tt> option for syntax help:</p>
<div class="highlight-python"><pre>$ sudo -u www-data php occ -h</pre>
</div>
<p>Display your ownCloud version:</p>
<div class="highlight-python"><pre>$ sudo -u www-data php occ -V
  ownCloud version 7.0.4</pre>
</div>
<p>Query your ownCloud server status:</p>
<div class="highlight-python"><pre>$ sudo -u www-data php occ status
  Array
  (
   [installed] =&gt; true
   [version] =&gt; 7.0.4.2
   [versionstring] =&gt; 7.0.4
   [edition] =&gt;
  )</pre>
</div>
<p><tt class="docutils literal"><span class="pre">occ</span></tt> has options, commands, and arguments. Options and arguments are
optional, while commands are required. The syntax is:</p>
<div class="highlight-python"><pre>occ [options] command [arguments]</pre>
</div>
<p>Get detailed information on individual commands with the <tt class="docutils literal"><span class="pre">help</span></tt> command, like
this example for the <tt class="docutils literal"><span class="pre">maintenance:mode</span></tt> command:</p>
<div class="highlight-python"><pre>$ sudo -u www-data php occ help maintenance:mode
  Usage:
  maintenance:mode [--on] [--off]

  Options:
  --on                  enable maintenance mode
  --off                 disable maintenance mode
  --help (-h)           Display this help message.
  --quiet (-q)          Do not output any message.
  --verbose (-v|vv|vvv) Increase the verbosity of messages: 1 for normal
  output, 2 for more verbose output and 3 for debug
  --version (-V)        Display this application version.
  --ansi                Force ANSI output.
  --no-ansi             Disable ANSI output.
  --no-interaction (-n) Do not ask any interactive question.</pre>
</div>
<div class="section" id="maintenance-commands">
<h2>Maintenance Commands<a class="headerlink" href="#maintenance-commands" title="Permalink to this headline">Â¶</a></h2>
<p>These three maintenance commands put your ownCloud server into
maintenance and single-user mode, and run repair steps during updates.</p>
<p>You must put your ownCloud server into maintenance mode whenever you perform an
update or upgrade. This locks the sessions of all logged-in users, including
administrators, and displays a status screen warning that the server is in
maintenance mode. Users who are not already logged in cannot log in until
maintenance mode is turned off. When you take the server out of maintenance
mode
logged-in users must refresh their Web browsers to continue working:</p>
<div class="highlight-python"><pre>$ sudo -u www-data php occ maintenance:mode --on
$ sudo -u www-data php occ maintenance:mode --off</pre>
</div>
<p>Putting your ownCloud server into single-user mode allows admins to log in and
work, but not ordinary users. This is useful for performing maintenance and
troubleshooting on a running server:</p>
<div class="highlight-python"><pre>$ sudo -u www-data php occ maintenance:singleuser --on
  Single user mode enabled</pre>
</div>
<p>And turn it off when you&#8217;re finished:</p>
<div class="highlight-python"><pre>$ sudo -u www-data php occ maintenance:singleuser --off
  Single user mode disabled</pre>
</div>
<p>The <tt class="docutils literal"><span class="pre">maintenance:repair</span></tt> command runs automatically during upgrades to clean
up the database, so while you can run it manually there usually isn&#8217;t a need
to:</p>
<div class="highlight-python"><pre>$ sudo -u www-data php occ maintenance:repair
  - Repair mime types
  - Repair config</pre>
</div>
</div>
<div class="section" id="user-commands">
<h2>User Commands<a class="headerlink" href="#user-commands" title="Permalink to this headline">Â¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">user</span></tt> commands reset passwords, display a simple report showing how
many users you have, and when a user was last logged in.</p>
<p>You can reset any user&#8217;s password, including administrators (see
<a class="reference internal" href="../configuration_user/reset_admin_password.html"><em>Resetting a Lost Admin Password</em></a>). In this example the
username is layla:</p>
<div class="highlight-python"><pre>$ sudo -u www-data php occ user:resetpassword layla
  Enter a new password:
  Confirm the new password:
  Successfully reset password for layla</pre>
</div>
<p>View a user&#8217;s most recent login:</p>
<div class="highlight-python"><pre>$ sudo -u www-data php occ user:lastseen layla
layla's last login: 09.01.2015 18:46</pre>
</div>
<p>Generate a simple report that counts all users, including users on external user
authentication servers such as LDAP:</p>
<div class="highlight-python"><pre>$ sudo -u www-data php occ user:report
+------------------+----+
| User Report      |    |
+------------------+----+
| Database         | 12 |
| LDAP             | 86 |
|                  |    |
| total users      | 98 |
|                  |    |
| user directories | 2  |
+------------------+----+</pre>
</div>
</div>
<div class="section" id="apps-commands">
<h2>Apps Commands<a class="headerlink" href="#apps-commands" title="Permalink to this headline">Â¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">app</span></tt> commands list, enable, and disable apps. This lists all of your
installed apps, and shows whether they are enabled or disabled:</p>
<div class="highlight-python"><pre>$ sudo -u www-data php occ app:list</pre>
</div>
<p>Enable an app:</p>
<div class="highlight-python"><pre>$ sudo -u www-data php occ app:enable external
  external enabled</pre>
</div>
<p>Disable an app:</p>
<div class="highlight-python"><pre>$ sudo -u www-data php occ app:disable external
  external disabled</pre>
</div>
</div>
<div class="section" id="upgrade-command">
<h2>Upgrade Command<a class="headerlink" href="#upgrade-command" title="Permalink to this headline">Â¶</a></h2>
<p>When you are performing an update or upgrade on your ownCloud server (see the
Maintenance section of this manual), it is better to use <tt class="docutils literal"><span class="pre">occ</span></tt> to perform the
database upgrade step, rather than the Web GUI,  in order to avoid timeouts.
PHP
scripts invoked from the Web interface are limited to 3600 seconds. In larger
environments this may not be enough, leaving the system in an inconsistent
state. Use this command to upgrade your databases:</p>
<div class="highlight-python"><pre>$ sudo -u www-data php occ upgrade</pre>
</div>
<p>Before completing the upgrade, ownCloud first runs a simulation by
copying all database tables to a temporary directory and then performing the
upgrade on them, to ensure that the upgrade will complete correctly. This
takes twice as much time, which on large installations can be many hours, so
you can omit this step with the <tt class="docutils literal"><span class="pre">--skip-migration-test</span></tt> option:</p>
<div class="highlight-python"><pre>$ sudo -u www-data php occ upgrade --skip-migration-test</pre>
</div>
<p>You can perform this simulation manually with the <tt class="docutils literal"><span class="pre">--dry-run</span></tt> option:</p>
<div class="highlight-python"><pre>$ sudo -u www-data php occ upgrade --dry-run</pre>
</div>
</div>
<div class="section" id="database-conversion">
<h2>Database Conversion<a class="headerlink" href="#database-conversion" title="Permalink to this headline">Â¶</a></h2>
<p>The SQLite database is good for testing, and for ownCloud servers with small
workloads, but production servers with multiple users should use MariaDB,
MySQL,
or PostgreSQL. You can use <tt class="docutils literal"><span class="pre">occ</span></tt> to convert from SQLite to one of these other
databases. You need:</p>
<ul class="simple">
<li>Your desired database installed and its PHP connector</li>
<li>The login and password of a database admin user</li>
<li>The database port number, if it is a non-standard port</li>
</ul>
<p>This is example converts to MySQL/MariaDB:</p>
<div class="highlight-python"><pre>$ sudo -u www-data php occ db:generate-change-script
$ sudo -u www-data php occ db:convert-type mysql oc_dbuser 127.0.0.1
oc_database</pre>
</div>
<p>For a more detailed explanation see
<a class="reference internal" href="../configuration_database/db_conversion.html"><em>Converting Database Type</em></a></p>
</div>
<div class="section" id="ldap-commands">
<h2>LDAP Commands<a class="headerlink" href="#ldap-commands" title="Permalink to this headline">Â¶</a></h2>
<p>You can run the following LDAP commands with <tt class="docutils literal"><span class="pre">occ</span></tt>.</p>
<p>Search for an LDAP user, using this syntax:</p>
<div class="highlight-python"><pre>$ sudo -u www-data php occ ldap:search [--group] [--offset="..."]
[--limit="..."] search</pre>
</div>
<p>This example searches for usernames that includes &#8220;rob&#8221;:</p>
<div class="highlight-python"><pre>$ sudo -u www-data php occ ldap:search rob</pre>
</div>
<p>Check if an LDAP user exists. This works only if the ownCloud server is
connected to an LDAP server:</p>
<div class="highlight-python"><pre>$ sudo -u www-data php occ ldap:check-user robert</pre>
</div>
<p>You can see your whole LDAP configuration, or the configuration for a single
configID:</p>
<div class="highlight-python"><pre>$ sudo -u www-data php occ ldap:show-config
$ sudo -u www-data php occ ldap:show-config s01</pre>
</div>
<p>The <tt class="docutils literal"><span class="pre">ldap:set-config</span></tt> command is for manipulating configurations, like this
example that sets search attributes:</p>
<div class="highlight-python"><pre>$ sudo -u www-data php occ ldap:set-config s01 ldapAttributesForUserSearch
"cn;givenname;sn;displayname;mail"</pre>
</div>
<p><tt class="docutils literal"><span class="pre">ldap:test-config</span></tt> tests whether your configuration is correct can bind to
the server:</p>
<div class="highlight-python"><pre>$ sudo -u www-data php occ ldap:test-config ""
The configuration is valid and the connection could be established!</pre>
</div>
</div>
<div class="section" id="file-scanning">
<h2>File Scanning<a class="headerlink" href="#file-scanning" title="Permalink to this headline">Â¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">files:scan</span></tt> command scans for new files for the file cache, and isn&#8217;t
intended to be run manually.</p>
</div>
</div>


					</div>
				</div>
			</div>
    
  </div>
</div>
  </body>
</html>